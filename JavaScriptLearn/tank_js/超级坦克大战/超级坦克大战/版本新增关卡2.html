<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8" />
		<title>坦克大战-v4.2</title>
	</head>
	<style type="text/css">
		input {
			position: absolute;
			width: 100px;
			height: 50px;
			font-family: "微软雅黑";
			font-size: 20px;
			background: none;
			outline: none;
		}
		
		input:hover {
			background: orangered;
			color: white;
		}
	</style>

	<body>
	</body>
	<script type="text/javascript">
		var BEIJING = "#222";
		var width = screen.width;
		var height = screen.height;
		var can = document.createElement("canvas");
		can.width = 1100;
		can.height = 700;
		var cx = (width - can.width) / 2;
		var cy = 0;
		can.style.position = "absolute";
		can.style.backgroundColor = "#222";
		can.style.left = cx + "px";
		can.style.top = cy + "px";
		document.body.appendChild(can);

		var div0 = document.createElement("div");
		div0.style.position = "absolute";
		div0.style.left = cx + "px";
		div0.style.width = can.width + "px";
		div0.style.height = can.height + "px";
		div0.style.background = "darkslateblue";

		var font = document.createElement("font"); //speed
		font.style.textAlign = "center";
		font.style.position = "absolute";
		font.style.left = cx + "px";
		font.style.top = can.height + 100 + "px";
		font.style.width = can.width + "px";
		font.style.height = 60 + "px";
		font.innerHTML = "<b style='color: red;font-family: 微软雅黑;font-size: 40px;'>游戏中飞机会掉落随机道具，敌人吃到会对我军不利</b>"
		document.body.appendChild(font);

		var sm = false; //控制说明弹窗的变量
		var shuoming = document.createElement("input");
		shuoming.type = "button";
		shuoming.value = "游戏说明";
		shuoming.style.left = cx - 200 + "px";
		shuoming.style.top = 100 + "px";
		shuoming.addEventListener("click", function() {
			sm = !sm;
			var top = 30;
			var xxx = 30;
			if(sm) {
				document.body.appendChild(div0);
				var th = document.createElement("div"); //speed
				th.style.position = "absolute";
				th.style.left = 60 + "px";
				th.style.top = top - 20 + "px";
				th.style.width = can.width + "px";
				th.style.height = 60 + "px";
				th.innerHTML = "<b style='color: yellow;font-family: 微软雅黑;font-size: 30px;'>道具图片&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我军吃到效果&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;敌军吃到效果</b>"
				div0.appendChild(th);
				top += xxx;
				var div1 = document.createElement("div"); //speed
				div1.style.position = "absolute";
				div1.style.left = 100 + "px";
				div1.style.top = top + "px";
				div1.style.width = can.width + "px";
				div1.style.height = 60 + "px";
				div1.style.background = "url(img/x0.gif)no-repeat";
				div1.style.backgroundSize = "30px 30px";
				div1.innerHTML = "<b style='color: red;font-family: 微软雅黑;font-size: 20px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;增加1点移动速度&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;增加1点移动速度</b>"
				div0.appendChild(div1);
				top += xxx;
				var div2 = document.createElement("div"); //life
				div2.style.position = "absolute";
				div2.style.left = 100 + "px";
				div2.style.top = top + "px";
				div2.style.width = can.width + "px";
				div2.style.height = 60 + "px";
				div2.style.background = "url(img/x1.gif)no-repeat";
				div2.style.backgroundSize = "30px 30px";
				div2.innerHTML = "<b style='color: red;font-family: 微软雅黑;font-size: 20px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;增加1条命&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;增加5个敌人</b>"
				div0.appendChild(div2);
				top += xxx;
				var div3 = document.createElement("div"); //ice
				div3.style.position = "absolute";
				div3.style.left = 100 + "px";
				div3.style.top = top + "px";
				div3.style.width = can.width + "px";
				div3.style.height = 60 + "px";
				div3.style.background = "url(img/x2.gif)no-repeat";
				div3.style.backgroundSize = "30px 30px";
				div3.innerHTML = "<b style='color: red;font-family: 微软雅黑;font-size: 20px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;冰冻敌人5秒&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我军冰冻5秒</b>"
				div0.appendChild(div3);
				top += xxx;
				var div4 = document.createElement("div"); //atk
				div4.style.position = "absolute";
				div4.style.left = 100 + "px";
				div4.style.top = top + "px";
				div4.style.width = can.width + "px";
				div4.style.height = 60 + "px";
				div4.style.background = "url(img/x3.gif)no-repeat";
				div4.style.backgroundSize = "30px 30px";
				div4.innerHTML = "<b style='color: red;font-family: 微软雅黑;font-size: 20px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;攻击力加一级&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;攻击力加一级</b>"
				div0.appendChild(div4);
				top += xxx;
				var div5 = document.createElement("div"); //def
				div5.style.position = "absolute";
				div5.style.left = 100 + "px";
				div5.style.top = top + "px";
				div5.style.width = can.width + "px";
				div5.style.height = 60 + "px";
				div5.style.background = "url(img/x4.gif)no-repeat";
				div5.style.backgroundSize = "30px 30px";
				div5.innerHTML = "<b style='color: red;font-family: 微软雅黑;font-size: 20px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;防御力加一级&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;防御力加一级</b>"
				div0.appendChild(div5);
				top += xxx;
				var div6 = document.createElement("div"); //home
				div6.style.position = "absolute";
				div6.style.left = 100 + "px";
				div6.style.top = top + "px";
				div6.style.width = can.width + "px";
				div6.style.height = 60 + "px";
				div6.style.background = "url(img/x5.gif)no-repeat";
				div6.style.backgroundSize = "30px 30px";
				div6.innerHTML = "<b style='color: red;font-family: 微软雅黑;font-size: 20px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;家周围的墙加20血&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;家周围的墙减20血</b>"
				div0.appendChild(div6);
				top += xxx;
				var div7 = document.createElement("div"); //hp++
				div7.style.position = "absolute";
				div7.style.left = 100 + "px";
				div7.style.top = top + "px";
				div7.style.width = can.width + "px";
				div7.style.height = 60 + "px";
				div7.style.background = "url(img/x6.gif)no-repeat";
				div7.style.backgroundSize = "30px 30px";
				div7.innerHTML = "<b style='color: red;font-family: 微软雅黑;font-size: 20px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;恢复30HP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;恢复30HP</b>"
				div0.appendChild(div7);
				top += xxx;
				var div8 = document.createElement("div"); //hp--
				div8.style.position = "absolute";
				div8.style.left = 100 + "px";
				div8.style.top = top + "px";
				div8.style.width = can.width + "px";
				div8.style.height = 60 + "px";
				div8.style.background = "url(img/x7.gif)no-repeat";
				div8.style.backgroundSize = "30px 30px";
				div8.innerHTML = "<b style='color: red;font-family: 微软雅黑;font-size: 20px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;损失随机的生命值&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;损失随机的生命值</b>"
				div0.appendChild(div8);
				top += xxx;
				var div9 = document.createElement("div"); //cmd
				div9.style.position = "absolute";
				div9.style.left = 100 + "px";
				div9.style.top = top + "px";
				div9.style.width = can.width + "px";
				div9.style.height = 60 + "px";
				div9.style.background = "url(img/x8.gif)no-repeat";
				div9.style.backgroundSize = "30px 30px";
				div9.innerHTML = "<b style='color: red;font-family: 微软雅黑;font-size: 20px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;增加指挥官30HP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;所有敌人增加随机HP，并多出3个敌人</b>"
				div0.appendChild(div9);
				top += xxx;
				var div10 = document.createElement("div"); //mine
				div10.style.position = "absolute";
				div10.style.left = 100 + "px";
				div10.style.top = top + "px";
				div10.style.width = can.width + "px";
				div10.style.height = 60 + "px";
				div10.style.background = "url(img/x9.gif)no-repeat";
				div10.style.backgroundSize = "30px 30px";
				div10.innerHTML = "<b style='color: red;font-family: 微软雅黑;font-size: 20px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;增加两个地雷&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;所有敌人增加1级防御，并多出3个敌人</b>"
				div0.appendChild(div10);
				top += xxx*2;
				var div11 = document.createElement("div"); //cmd
				div11.style.position = "absolute";
				div11.style.textAlign = "center";
				div11.style.left = 85 + "px";
				div11.style.top = top + "px";
				div11.style.width = can.width/3 + "px";
				div11.style.height = 60 + "px";
				div11.style.background = "url(img/坦克3U.gif)no-repeat";
				div11.style.backgroundSize = "60px 60px";
				div11.innerHTML = "<b style='color: greenyellow;font-family: 微软雅黑;font-size: 40px;'>玩家坦克</b>"
				div0.appendChild(div11);
				top += xxx*3;
				var div12 = document.createElement("div"); //cmd
				div12.style.position = "absolute";
				div12.style.textAlign = "center";
				div12.style.left = 85 + "px";
				div12.style.top = top + "px";
				div12.style.width = can.width/3 + "px";
				div12.style.height = 60 + "px";
				div12.style.background = "url(img/tankU.gif)no-repeat";
				div12.style.backgroundSize = "60px 60px";
				div12.innerHTML = "<b style='color: greenyellow;font-family: 微软雅黑;font-size: 40px;'>敌方普通坦克</b>"
				div0.appendChild(div12);
				top += xxx*3;
				var div13 = document.createElement("div"); //cmd
				div13.style.position = "absolute";
				div13.style.textAlign = "center";
				div13.style.left = 85 + "px";
				div13.style.top = top + "px";
				div13.style.width = can.width/3 + "px";
				div13.style.height = 60 + "px";
				div13.style.background = "url(img/dU.gif)no-repeat";
				div13.style.backgroundSize = "60px 60px";
				div13.innerHTML = "<b style='color: greenyellow;font-family: 微软雅黑;font-size: 40px;'>敌方精英坦克</b>"
				div0.appendChild(div13);
				top -= xxx * 6;
				var div14 = document.createElement("div"); //cmd
				div14.style.position = "absolute";
				div14.style.textAlign = "center";
				div14.style.left = 500 + "px";
				div14.style.top = top + "px";
				div14.style.width = can.width/7 + "px";
				div14.style.height = 60 + "px";
				div14.style.background = "url(img/w0L.png)no-repeat";
				div14.style.backgroundSize = "20px 10px";
				div14.innerHTML = "<b style='color: deepskyblue;font-family: 微软雅黑;font-size: 15px;'>1级子弹</b>"
				div0.appendChild(div14);
				var div15 = document.createElement("div"); //cmd
				div15.style.position = "absolute";
				div15.style.left = 630 + "px";
				div15.style.top = top + "px";
				div15.style.width = can.width/7 + "px";
				div15.style.height = 60 + "px";
				div15.style.background = "url(img/m0L.png)no-repeat";
				div15.style.backgroundSize = "20px 10px";
				div0.appendChild(div15);
				top += xxx;
				var div16 = document.createElement("div"); //cmd
				div16.style.position = "absolute";
				div16.style.textAlign = "center";
				div16.style.left = 500 + "px";
				div16.style.top = top + "px";
				div16.style.width = can.width/7 + "px";
				div16.style.height = 60 + "px";
				div16.style.background = "url(img/w1L.png)no-repeat";
				div16.style.backgroundSize = "20px 10px";
				div16.innerHTML = "<b style='color: deepskyblue;font-family: 微软雅黑;font-size: 15px;'>2级子弹</b>"
				div0.appendChild(div16);
				var div17 = document.createElement("div"); //cmd
				div17.style.position = "absolute";
				div17.style.left = 630 + "px";
				div17.style.top = top + "px";
				div17.style.width = can.width/7 + "px";
				div17.style.height = 60 + "px";
				div17.style.background = "url(img/m1L.png)no-repeat";
				div17.style.backgroundSize = "20px 10px";
				div0.appendChild(div17);
				top += xxx;
				var div18 = document.createElement("div"); //cmd
				div18.style.position = "absolute";
				div18.style.textAlign = "center";
				div18.style.left = 500 + "px";
				div18.style.top = top + "px";
				div18.style.width = can.width/7 + "px";
				div18.style.height = 60 + "px";
				div18.style.background = "url(img/w2L.png)no-repeat";
				div18.style.backgroundSize = "20px 10px";
				div18.innerHTML = "<b style='color: deepskyblue;font-family: 微软雅黑;font-size: 15px;'>3级子弹</b>"
				div0.appendChild(div18);
				var div19 = document.createElement("div"); //cmd
				div19.style.position = "absolute";
				div19.style.left = 630 + "px";
				div19.style.top = top + "px";
				div19.style.width = can.width/7 + "px";
				div19.style.height = 60 + "px";
				div19.style.background = "url(img/m2L.png)no-repeat";
				div19.style.backgroundSize = "20px 10px";
				div0.appendChild(div19);
				top += xxx;
				var div20 = document.createElement("div"); //cmd
				div20.style.position = "absolute";
				div20.style.textAlign = "center";
				div20.style.left = 500 + "px";
				div20.style.top = top + "px";
				div20.style.width = can.width/7 + "px";
				div20.style.height = 60 + "px";
				div20.style.background = "url(img/w3L.png)no-repeat";
				div20.style.backgroundSize = "20px 10px";
				div20.innerHTML = "<b style='color: deepskyblue;font-family: 微软雅黑;font-size: 15px;'>4级子弹</b>"
				div0.appendChild(div20);
				var div21 = document.createElement("div"); //cmd
				div21.style.position = "absolute";
				div21.style.left = 630 + "px";
				div21.style.top = top + "px";
				div21.style.width = can.width/7 + "px";
				div21.style.height = 60 + "px";
				div21.style.background = "url(img/m3L.png)no-repeat";
				div21.style.backgroundSize = "20px 10px";
				div0.appendChild(div21);
				top += xxx;
				var div22 = document.createElement("div"); //cmd
				div22.style.position = "absolute";
				div22.style.textAlign = "center";
				div22.style.left = 500 + "px";
				div22.style.top = top + "px";
				div22.style.width = can.width/7 + "px";
				div22.style.height = 60 + "px";
				div22.style.background = "url(img/w4L.png)no-repeat";
				div22.style.backgroundSize = "20px 10px";
				div22.innerHTML = "<b style='color: deepskyblue;font-family: 微软雅黑;font-size: 15px;'>5级子弹</b>"
				div0.appendChild(div22);
				var div23 = document.createElement("div"); //cmd
				div23.style.position = "absolute";
				div23.style.left = 630 + "px";
				div23.style.top = top + "px";
				div23.style.width = can.width/7 + "px";
				div23.style.height = 60 + "px";
				div23.style.background = "url(img/m4L.png)no-repeat";
				div23.style.backgroundSize = "20px 10px";
				div0.appendChild(div23);
				top -= xxx*4;
				var div24 = document.createElement("div"); //cmd
				div24.style.position = "absolute";
				div24.style.textAlign = "center";
				div24.style.left = 700 + "px";
				div24.style.top = top + "px";
				div24.style.width = can.width/2 + "px";
				div24.style.height = 200 + "px";
				div24.style.background = "url(img/boss1D.gif)no-repeat";
				div24.style.backgroundSize = "200px 200px";
				div24.innerHTML = "<b style='color: deeppink;font-family: 微软雅黑;font-size: 30px;'>敌方boss</b>"
				div0.appendChild(div24);
			} else {
				var div = document.getElementsByTagName("div");
				for(var i = 25; i >= 0; i--) {
					div[i].remove();
				}
			}
		})
		document.body.appendChild(shuoming);

		var guan2 = document.createElement("input"); //关卡2
		guan2.type = "button";
		guan2.value = "不可能完成的任务";
		guan2.style.width = "200px";
		guan2.style.left = cx - 250 + "px";
		guan2.style.top = 400 + "px";
		guan2.addEventListener("click", dierguan);
		document.body.appendChild(guan2);

		var g = can.getContext("2d");
		var UNIT = 0; //每个物体的编号
		var WOJUN = "我军";
		var QIANG = "墙";
		var CMD = "指挥官";
		var DIJUN = "敌军";
		var ZIDAN = "子弹";
		var DILEI = "地雷";
		var DAOJU = "道具";
		var TUPIAN = "图片";
		var FEIJI = "飞机";

		var TANK_W = 40;
		var TANK_H = 40;
		var DI_W = 40;
		var DI_H = 40;
		var WO_IMG = "img/坦克3U.gif";
		var DI_IMG = "img/tankD.gif";
		var BOSS_IMG = "img/boss1D.gif";
		var BOSSHP = 10000;
		var dier = false;
		var boss = new Object();
		boss.life = 0;

		var FJ_W = 80;
		var FJ_H = 80;
		var MM_W = 50;
		var MM_H = 70;
		var DJ_W = 30;
		var DJ_H = 30;

		var WALL_W = 30;
		var WALL_H = 30;
		var zhb = []; //保存8块指挥部的墙
		var kill = [12, 16, 20, 24, 28];
		var def = [0, 2, 5, 8, 10];
		var z1 = [4, 6, 8, 10, 12];
		var z2 = [10, 12, 15, 19, 22];
		var zt = ["未开始", "激战中", "暂停", "胜利", "任务失败", "冰冻", "被冰冻", "无敌", "待复活", "boss登场", "boss"];
		var wallcount = 36; //墙块数量
		var wallcount2 = 28; //第二层的墙数量
		var enemycount = 20; //敌人数量
		var jianmie = 0; //歼灭数量
		var zhuangtai = zt[0]; //游戏状态默认
		var kaishitimer = null; //开始文字闪烁的定时器
		var kaishicolor = false;
		var tempstate = zt[1]; //记录临时状态的变量
		var bdtimer = null; //冰冻定时器
		var bdshijian = 5; //冰冻时间
		var djshijian = 9; //倒计时时间
		var djstimer = null; //倒计时定时器
		var overy = 780; //游戏结束时文字y轴
		var overtimer = null; //游戏结束时的文字定时器
		var shantimer = null; //无敌闪烁的定时器
		var shan = false; //闪烁
		var shanshijian = 3 //闪的时间
		var timer9 = null; //控制闪烁时间的定时器

		var gametime = 280; //最开始的时间（秒）
		var gametimer = null; //游戏定时器

		var jifen = 0; //积分（杀死普通坦克得100分，英雄坦克得150分）
		var fjcount = 0; //飞机数量

		var bgm1 = new Audio();
		bgm1.src = "sounds/bgm1.mp3";
		bgm1.loop = "loop";
		bgm1.play();

		function Stage() {
			this.data = [];
		}

		Stage.prototype.add = function(o) {
			this.data.push(o); //把对象o扔进数组中
		}

		Stage.prototype.remove = function(o) {
			var index = this.data.indexOf(o);
			if(index != -1) {
				this.data.splice(index, 1); //从数组中删除一个元素
			}
		}

		Stage.prototype.render = function() { //屏幕重复渲染
			var list = this.data;

			function loop() {
				//清屏
				//				g.fillStyle = BEIJING;
				//				g.fillRect(0, 0, can.width, can.height);

				var bg = new Image();
				bg.src = "img/ditudark.jpg";
				g.drawImage(bg, 0, 0, can.width, can.height);

				huabeijing();
				huaxinxi();
				huashuoming();
				huazuozhe();
				huakaishi();
				huajishi();
				huazanting();
				huadaojishi();
				huaover();
				huatime();
				huajifen();

				huataopao();

				list.forEach(function(o) {
					o.show();
				});

				requestAnimationFrame(loop);
			}
			loop();
		}

		function huabeijing() {
			//			var x = (can.width - 90 * 4) / 2,
			//				y = can.height / 2 + 50;
			//			g.fillStyle = "#444";
			//			g.font = "90px 楷体";
			//			g.fillText("坦克争爸", x, y);
		}

		function huataopao() {
			if(zhuangtai != zt[9]) return;
			g.fillStyle = "#FFFFFF";
			g.font = "15px 微软雅黑";
			g.fillText("你已经被强化了，我先走一步，请小心", mm.x, mm.y - 20);
		}

		function huaxinxi() {
			var x = 30,
				y = 30;
			g.fillStyle = "#ddd";
			g.font = "15px 微软雅黑";
			g.fillText("敌军数量：" + enemycount, x, y);
			x += 110;
			g.fillText("歼灭数量：" + jianmie, x, y);
			x += 110;
			g.fillText("生命值：" + wo.life, x, y);
			x += 110;
			g.fillText("复活机会：" + wo.fuhuo, x, y);
			x += 110;
			g.fillText("攻：" + wo.gong, x, y);
			x += 60;
			g.fillText("防：" + wo.fang, x, y);
			x += 60;
			g.fillText("移动速度：" + wo.speed, x, y);
			x += 110;
			g.fillText("可用地雷：" + wo.dilei, x, y);
			x += 110;
			g.fillText("游戏状态：", x, y);
			x += 80;
			g.fillStyle = "coral";
			g.fillText(zhuangtai, x, y);
		}

		function huashuoming() {
			var x = 10,
				y = 300;
			g.fillStyle = "#777";
			g.font = "15px 宋体";
			g.fillText("操作说明：", x, y), y += 20;
			g.fillText("空格----发射子弹", x, y), y += 20;
			g.fillText("P-------暂停", x, y), y += 20;
			g.fillText("B-------埋雷", x, y), y += 20;
			g.fillText("R-------复活", x, y), y += 20;
			g.fillText("A-------大招（使用一次掉3点血）", x, y), y += 20;
		}

		function huazuozhe() {
			var x = 30,
				y = can.height - 30;
			g.fillStyle = "#666";
			g.font = "15px 宋体";
			g.fillText("作者：李显", x, y);
		}

		function huakaishi() {
			if(zhuangtai != zt[0]) return;
			var x = (can.width - 40 * 8.5) / 2,
				y = can.height / 2 - 80;
			if(kaishicolor) {
				g.fillStyle = "#fff";
				g.font = "40px 黑体";
				g.fillText("按【Y】键开始游戏", x, y);
			}

			var bg = new Image();
			bg.src = "img/bg2.gif";
			g.drawImage(bg, (can.width - 900) / 2, can.height - 400 - 50, 900, 400);
		}

		function huajishi() {
			if(zhuangtai != zt[5] && zhuangtai != zt[6]) return;
			var x = (can.width - 50) / 2,
				y = can.height - 180;
			g.fillStyle = zhuangtai == zt[6] ? "red" : "green";
			g.font = "80px 黑体";
			g.fillText(bdshijian, x, y);
		}

		function huazanting() {
			if(zhuangtai != zt[2]) return;
			var x = (can.width - 40 * 8.5) / 2,
				y = can.height / 2 - 80;
			g.fillStyle = "#FFF";
			g.font = "40px 黑体";
			g.fillText("按【P】键继续游戏", x, y);
		}

		function huadaojishi() {
			if(zhuangtai != zt[8]) return;
			var x = (can.width - 150) / 2,
				y = can.height - 280;
			g.fillStyle = "yellow";
			g.font = "280px 黑体";
			g.fillText(djshijian, x, y);
		}

		function huaover() {
			if(zhuangtai != zt[4]) return;
			var x = (can.width - 380) / 2;
			g.fillStyle = "red";
			g.font = "80px Consolas";
			g.fillText("Game over", x, overy);
		}

		function huatime() {
			var x = can.width - 60,
				y = 30;
			g.fillStyle = "lightgreen";
			g.font = "18px 微软雅黑";
			g.fillText(gametime, x, y);
		}

		function huajifen() {
			var x = 30,
				y = 70;
			g.fillStyle = "aqua";
			g.font = "16px 微软雅黑";
			g.fillText("积分：" + jifen, x, y);
		}

		/**父类**/
		function Base(x, y, w, h, src, type) {
			this.x = x;
			this.y = y;
			this.w = w;
			this.h = h;
			this.src = src; //图片名
			this.type = type; //类别
			this.life = 100; //生命值
			this.index = UNIT++; //唯一的编号
			this.img = new Image();
			this.img.src = this.src;
			this.show = function() {
				g.drawImage(this.img, this.x, this.y, this.w, this.h);
				if(this.type == WOJUN || this.type == DIJUN || this.type == QIANG || this.type == CMD || this.type == FEIJI) {
					this.blood();
				}
			}

			this.die = function() {
				stage.remove(this);
				clearInterval(this.movetimer);
				if(this.type == DIJUN || this.type == WOJUN || this.type == FEIJI) {
					if(this.life <= 0) {
						this.boom();
						bofang("bomb2.wav");
					}
				}
				this.life = 0;
				if(this.type == DIJUN) {
					enemycount--;
					jianmie++;
					if(enemycount == 0) {
						zhuangtai = zt[3];
						if(!dier) {
							dierguan();
						}
					}
					clearInterval(this.kongzhitimer);
					jifen += this.hero ? 150 : 100;
				} else if(this.type == WOJUN) {
					zhuangtai = wo.fuhuo > 0 ? zt[8] : zt[4];
					bofang("cao.wav");
					if(wo.fuhuo > 0) {
						djstimer = setInterval(function() {
							djshijian--;
							bofang("peng.wav");
							if(djshijian < 0) {
								clearInterval(djstimer);
								wo.fuhuo = 0;
								zhuangtai = zt[4];
								over();
							}
						}, 1100)
					} else {
						over();
					}
				} else if(this.type == CMD) {
					wo.fuhuo = 0;
					wo.life = 0;
					wo.die();
					zhuangtai = zt[4];
					bofang("hedan.wav");
					bofang("hithe.wav");
					over();
				}
			}
		}

		function Dilei(tank) {
			var x = tank.x + (tank.w - DJ_W) / 2;
			var y = tank.y + (tank.h - DJ_H) / 2;
			var o = new Base(x - 1, y - 1, DJ_W, DJ_H, "img/x10.gif", DILEI);
			o.n = 10;
			return o;
		}

		function Daoju(tank) {
			var x = tank.x + (tank.w - DJ_W) / 2;
			var y = tank.y + (tank.h - DJ_H) / 2;
			var n = parseInt(Math.random() * 10);

			if(boss.life > 0) {
				while(n == 5 || n == 8) {
					n = parseInt(Math.random() * 10);
				}
			}
			var o = new Base(x - 1, y - 1, DJ_W, DJ_H, "img/x" + n + ".gif", DAOJU);
			o.n = n;
			return o;
		}

		function Baozha(tank) {
			var x = tank.x - 5;
			var y = tank.y - 5;
			var i = 0;
			var src = "img/" + i + ".gif";
			var o = new Base(x, y, tank.w + 10, tank.h + 10, src, TUPIAN);
			o.movetimer = setInterval(function() {
				if(zhuangtai == zt[2]) return; //爆炸效果暂停
				i++;
				o.img.src = "img/" + i + ".gif";
				if(i == 7) {
					clearInterval(o.movetimer);
					o.die();
					if(tank.type != DILEI && zhuangtai != zt[9]) {
						var dj = new Daoju(o);
						stage.add(dj);
					}
				}
			}, 100)
			return o;
		}

		function Zidan(tank) {
			var x = tank.x,
				y = tank.y;
			if(tank.dir == "U") {
				x += tank.w / 2 - 2;
				y -= 17;
			} else if(tank.dir == "R") {
				x += tank.w + 2;
				y += tank.h / 2 - 2;
			} else if(tank.dir == "L") {
				x -= 14;
				y += tank.h / 2 - 3;
			} else if(tank.dir == "D") {
				x += tank.w / 2 - 3;
				y += tank.h - 1;
			}

			if(tank.dir == "D") {
				if(tank.gong == 0) {
					x += 1;
				} else if(tank.gong == 3) {
					x -= 2;
				} else if(tank.gong == 4) {
					x -= 3;
					y += 2;
				}
			} else if(tank.dir == "U") {
				if(tank.gong == 1) {
					x -= 1;
				} else if(tank.gong == 2) {
					x -= 2;
				} else if(tank.gong == 3) {
					x -= 3;
					y -= 3;
				} else if(tank.gong == 4) {
					x -= 4;
					y -= 8;
				}
			} else if(tank.dir == "L") {
				if(tank.gong == 3) {
					x -= 5;
					y -= 1;
				} else if(tank.gong == 4) {
					x -= 10;
					y -= 4;
				}
			} else if(tank.dir == "R") {
				if(tank.gong == 2) {
					y -= 2;
				} else if(tank.gong == 3) {
					y -= 2;
				} else if(tank.gong == 4) {
					y -= 4;
				}
			}
			var w = 0,
				h = 0;
			if(tank.dir == "D" || tank.dir == "U") {
				w = z1[tank.gong] + (tank.isboss ? 10 : 0);
				h = z2[tank.gong] + (tank.isboss ? 30 : 0);
			} else {
				w = z2[tank.gong] + (tank.isboss ? 30 : 0);
				h = z1[tank.gong] + (tank.isboss ? 10 : 0);
			}
			var src = "img/" + (tank.isboss ? "w" : (tank.type == WOJUN ? "w" : "m")) + tank.gong + tank.dir + ".png";
			var o = new Base(x, y, w, h, src, ZIDAN);
			o.tank = tank; //记录子弹的发射者
			o.gong = kill[tank.gong]; //子弹的伤害点数==坦克的攻击等级对应的数字
			o.speed = 15;
			o.left = tank.dir == "L";
			o.right = tank.dir == "R";
			o.up = tank.dir == "U";
			o.down = tank.dir == "D";
			o.movetimer = setInterval(yidong, 30);

			function yidong() {
				if(zhuangtai == zt[2]) return;
				var ox = o.x;
				oy = o.y; //保存移动以前的旧标
				if(o.left) {
					o.x -= o.speed;
				} else if(o.right) {
					o.x += o.speed;
				} else if(o.up) {
					o.y -= o.speed;
				} else if(o.down) {
					o.y += o.speed;
				}
				if(checkOut(o)) { //移动后，发现坐标超出范围，就死掉
					o.die();
				}
				var r = pengzhuang(o);
				if(r.peng) { //是否与其他物体发生了碰撞，如果有就死掉
					o.die();
					r.o.shixue(o.gong); //调用被击中的对象的失血方法
					if(r.o.type == WOJUN) {
						bofang("hits.wav");
					} else if(r.o.type == CMD) {
						bofang("hitcmd.wav");
						bofang("hithe.wav");
					} else if(r.o.type == QIANG) {
						bofang("di.wav");
					}
				}

			}
			return o;
		}

		function Jiguang(tank) {
			var x1 = tank.x,
				y1 = tank.y,
				x2 = tank.x,
				y2 = tank.y;
			if(tank.dir == "U") {
				x1 += tank.w / 10;
				y1 += tank.h / 10;
				x2 += tank.w / 10 * 9;
				y2 += tank.h / 10;
			} else if(tank.dir == "R") {
				x1 += tank.w - tank.h / 10;
				y1 += tank.w / 10;
				x2 += tank.w - tank.h / 10;
				y2 += tank.w / 10 * 9;
			} else if(tank.dir == "L") {
				x1 += tank.h / 10;
				y1 += tank.w / 10;
				x2 += tank.h / 10;
				y2 += tank.w / 10 * 9;
			} else if(tank.dir == "D") {
				x1 += tank.w / 10;
				y1 += tank.h - tank.h / 10;
				x2 += tank.w / 10 * 9;
				y2 += tank.h - tank.h / 10;
			}

			var w = 0,
				h = 0;
			if(tank.dir == "D" || tank.dir == "U") {
				w = z1[tank.gong] + (tank.isboss ? 10 : 0);
				h = z2[tank.gong] + (tank.isboss ? 30 : 0);
			} else {
				w = z2[tank.gong] + (tank.isboss ? 30 : 0);
				h = z1[tank.gong] + (tank.isboss ? 10 : 0);
			}
			var src = "img/" + (tank.isboss ? "w" : (tank.type == WOJUN ? "w" : "m")) + tank.gong + tank.dir + ".png";
			var o = new Object();
			o.o1 = new Base(x1, y1, w, h, src, ZIDAN);
			o.o2 = new Base(x2, y2, w, h, src, ZIDAN);
			o.o1.tank = tank; //记录子弹的发射者
			o.o1.gong = kill[tank.gong]; //子弹的伤害点数==坦克的攻击等级对应的数字
			o.o1.speed = 25;
			o.o1.left = tank.dir == "L";
			o.o1.right = tank.dir == "R";
			o.o1.up = tank.dir == "U";
			o.o1.down = tank.dir == "D";
			o.o1.movetimer = setInterval(yidong, 10, o.o1);

			o.o2.tank = tank; //记录子弹的发射者
			o.o2.gong = kill[tank.gong]; //子弹的伤害点数==坦克的攻击等级对应的数字
			o.o2.speed = 25;
			o.o2.left = tank.dir == "L";
			o.o2.right = tank.dir == "R";
			o.o2.up = tank.dir == "U";
			o.o2.down = tank.dir == "D";
			o.o2.movetimer = setInterval(yidong, 10, o.o2);

			function yidong(o) {
				if(zhuangtai == zt[2]) return;
				var ox = o.x;
				oy = o.y; //保存移动以前的旧标
				if(o.left) {
					o.x -= o.speed;
				} else if(o.right) {
					o.x += o.speed;
				} else if(o.up) {
					o.y -= o.speed;
				} else if(o.down) {
					o.y += o.speed;
				}
				if(checkOut(o)) { //移动后，发现坐标超出范围，就死掉
					o.die();
				}
				var r = pengzhuang(o);
				if(r.peng) { //是否与其他物体发生了碰撞，如果有就死掉
					o.die();
					r.o.shixue(100); //调用被击中的对象的失血方法
					if(r.o.type == WOJUN) {
						bofang("hits.wav");
					} else if(r.o.type == CMD) {
						bofang("hitcmd.wav");
						bofang("hithe.wav");
					} else if(r.o.type == QIANG) {
						bofang("di.wav");
					}
				}

			}
			return o;
		}

		function Danmu(tank) {
			var x = tank.x + tank.w / 2,
				y = tank.y + tank.h / 2;
			var w = 16,
				h = 16;
			var danmuspeed = 0.5 + parseInt(Math.random() * 5);
			var src = "img/m0.gif";
			var o = new Object();
			o.o1 = new Base(x, y, w, h, src, ZIDAN);
			o.o2 = new Base(x, y, w, h, src, ZIDAN);
			o.o3 = new Base(x, y, w, h, src, ZIDAN);
			o.o4 = new Base(x, y, w, h, src, ZIDAN);
			o.o5 = new Base(x, y, w, h, src, ZIDAN);
			o.o6 = new Base(x, y, w, h, src, ZIDAN);
			o.o7 = new Base(x, y, w, h, src, ZIDAN);
			o.o8 = new Base(x, y, w, h, src, ZIDAN);
			o.o9 = new Base(x, y, w, h, src, ZIDAN);
			o.o10 = new Base(x, y, w, h, src, ZIDAN);
			o.o11 = new Base(x, y, w, h, src, ZIDAN);
			o.o12 = new Base(x, y, w, h, src, ZIDAN);
			o.o13 = new Base(x, y, w, h, src, ZIDAN);
			o.o14 = new Base(x, y, w, h, src, ZIDAN);
			o.o15 = new Base(x, y, w, h, src, ZIDAN);
			o.o16 = new Base(x, y, w, h, src, ZIDAN);

			o.o1.tank = tank; //记录子弹的发射者
			o.o1.speed = danmuspeed;
			o.o1.movetimer = setInterval(yidong, 10, o.o1, 1);

			o.o2.tank = tank; //记录子弹的发射者
			o.o2.speed = danmuspeed;
			o.o2.movetimer = setInterval(yidong, 10, o.o2, 2);

			o.o3.tank = tank; //记录子弹的发射者
			o.o3.speed = danmuspeed;
			o.o3.movetimer = setInterval(yidong, 10, o.o3, 3);

			o.o4.tank = tank; //记录子弹的发射者
			o.o4.speed = danmuspeed;
			o.o4.movetimer = setInterval(yidong, 10, o.o4, 4);

			o.o5.tank = tank; //记录子弹的发射者
			o.o5.speed = danmuspeed;
			o.o5.movetimer = setInterval(yidong, 10, o.o5, 5);

			o.o6.tank = tank; //记录子弹的发射者
			o.o6.speed = danmuspeed;
			o.o6.movetimer = setInterval(yidong, 10, o.o6, 6);

			o.o7.tank = tank; //记录子弹的发射者
			o.o7.speed = danmuspeed;
			o.o7.movetimer = setInterval(yidong, 10, o.o7, 7);

			o.o8.tank = tank; //记录子弹的发射者
			o.o8.speed = danmuspeed;
			o.o8.movetimer = setInterval(yidong, 10, o.o8, 8);

			o.o9.tank = tank; //记录子弹的发射者
			o.o9.speed = danmuspeed;
			o.o9.movetimer = setInterval(yidong, 10, o.o9, 9);

			o.o10.tank = tank; //记录子弹的发射者
			o.o10.speed = danmuspeed;
			o.o10.movetimer = setInterval(yidong, 10, o.o10, 10);

			o.o11.tank = tank; //记录子弹的发射者
			o.o11.speed = danmuspeed;
			o.o11.movetimer = setInterval(yidong, 10, o.o11, 11);

			o.o12.tank = tank; //记录子弹的发射者
			o.o12.speed = danmuspeed;
			o.o12.movetimer = setInterval(yidong, 10, o.o12, 12);

			o.o13.tank = tank; //记录子弹的发射者
			o.o13.speed = danmuspeed;
			o.o13.movetimer = setInterval(yidong, 10, o.o13, 13);

			o.o14.tank = tank; //记录子弹的发射者
			o.o14.speed = danmuspeed;
			o.o14.movetimer = setInterval(yidong, 10, o.o14, 14);

			o.o15.tank = tank; //记录子弹的发射者
			o.o15.speed = danmuspeed;
			o.o15.movetimer = setInterval(yidong, 10, o.o15, 15);

			o.o16.tank = tank; //记录子弹的发射者
			o.o16.speed = danmuspeed;
			o.o16.movetimer = setInterval(yidong, 10, o.o16, 16);

			function yidong(o, fx) {
				if(zhuangtai == zt[2]) return;
				var ox = o.x;
				oy = o.y; //保存移动以前的旧标
				if(fx == 1) {
					o.x -= o.speed;
					o.y -= o.speed;
				} else if(fx == 2) {
					o.x += o.speed;
					o.y += o.speed;
				} else if(fx == 3) {
					o.x -= o.speed;
					o.y += o.speed;
				} else if(fx == 4) {
					o.x += o.speed;
					o.y -= o.speed;
				} else if(fx == 5) {
					o.x += o.speed;
				} else if(fx == 6) {
					o.y -= o.speed;
				} else if(fx == 7) {
					o.x -= o.speed;
				} else if(fx == 8) {
					o.y += o.speed;
				} else if(fx == 9) {
					o.x -= o.speed;
					o.y -= o.speed / 2;
				} else if(fx == 10) {
					o.x -= o.speed;
					o.y += o.speed / 2;
				} else if(fx == 11) {
					o.x += o.speed;
					o.y -= o.speed / 2;
				} else if(fx == 12) {
					o.x += o.speed;
					o.y += o.speed / 2;
				} else if(fx == 13) {
					o.x += o.speed / 2;
					o.y += o.speed;
				} else if(fx == 14) {
					o.x += o.speed / 2;
					o.y -= o.speed;
				} else if(fx == 15) {
					o.x -= o.speed / 2;
					o.y += o.speed;
				} else if(fx == 16) {
					o.x -= o.speed / 2;
					o.y -= o.speed;
				}
				if(checkOut(o)) { //移动后，发现坐标超出范围，就死掉
					o.die();
				}
				var r = pengzhuang(o);
				if(r.peng) { //是否与其他物体发生了碰撞，如果有就死掉
					o.die();
					r.o.shixue(11); //调用被击中的对象的失血方法
					if(r.o.type == WOJUN) {
						bofang("hits.wav");
					} else if(r.o.type == CMD) {
						bofang("hitcmd.wav");
						bofang("hithe.wav");
					} else if(r.o.type == QIANG) {
						bofang("di.wav");
					}
				}

			}
			return o;
		}

		function Youxuetiao(x, y, w, h, src, type) {
			var o = new Base(x, y, w, h, src, type);
			o.blood = function() { //绘制本对象的血条
				if(o.life <= 0 || o.type == FEIJI) return;
				g.fillStyle = "red";
				if(o.life > (o.isboss ? BOSSHP * 0.8 : 80)) g.fillStyle = "springgreen";
				else if(o.life > (o.isboss ? BOSSHP * 0.6 : 60)) g.fillStyle = "yellow";
				else if(o.life > (o.isboss ? BOSSHP * 0.4 : 40)) g.fillStyle = "orangered";
				g.fillRect(o.x, o.y - 5, o.life / (o.isboss ? BOSSHP : 100) * o.w, 5);
			}
			o.shixue = function(many) {
				if(zhuangtai == zt[7] && o.type == WOJUN) return;
				o.life -= many;
				o.life += def[o.fang];
				if(o.life <= 0) {
					o.die();
				}
			}
			return o;
		}

		function Feiji() {
			var n = parseInt(Math.random() * 4); //决定飞机的图
			var f = parseInt(Math.random() * 4); //决定飞机的朝向
			var x = 200 + parseInt(Math.random() * (can.width - 400));
			var y = 100 + parseInt(Math.random() * (can.height - 200));
			var fx = "U";
			if(f == 0) { //上
				y = can.height - FJ_H;
			} else if(f == 1) { //下
				y = 0;
				fx = "D";
			} else if(f == 2) { //左
				x = can.width - FJ_W;
				fx = "L";
			} else if(f == 3) { //右
				x = 0;
				fx = "R";
			}
			var o = new Youxuetiao(x, y, FJ_W, FJ_H, "img/f" + n + fx + ".png", FEIJI);
			//			o.fang = 0;
			o.dir = fx;
			o.speed = 3;
			o.diaoluo = parseInt(Math.random() * (o.dir == "U" || o.dir == "D" ? can.height - 100 : can.width - 100));
			o.left = fx == "L";
			o.right = fx == "R";
			o.up = fx == "U";
			o.down = fx == "D";
			o.isdiao = true;
			o.movetimer = setInterval(yidong, 10);

			function yidong() {
				if(zhuangtai == zt[2] || zhuangtai == zt[5]) return;
				if(o.left) {
					o.x -= o.speed;
					if(o.x <= o.diaoluo && o.isdiao) {
						o.isdiao = false;
						var dj = new Daoju(o);
						stage.add(dj);
					}
				} else if(o.right) {
					o.x += o.speed;
					if(o.x >= o.diaoluo && o.isdiao) {
						o.isdiao = false;
						var dj = new Daoju(o);
						stage.add(dj);
					}
				} else if(o.up) {
					o.y -= o.speed;
					if(o.y <= o.diaoluo && o.isdiao) {
						o.isdiao = false;
						var dj = new Daoju(o);
						stage.add(dj);
					}
				} else if(o.down) {
					o.y += o.speed;
					if(o.y >= o.diaoluo && o.isdiao) {
						o.isdiao = false;
						var dj = new Daoju(o);
						stage.add(dj);
					}
				}
				if(checkOut(o)) { //移动后，发现坐标超出范围，就恢复为旧坐标
					o.die();
					fjcount--;
				}

			}
			o.boom = function() {
				var baozha = new Baozha(o);
				stage.add(baozha);
				fjcount--;
			}

			return o;
		}

		function Command(x, y, fang) {
			var o = new Youxuetiao(x, y, MM_W, MM_H, "img/p1.gif", CMD);
			o.fang = fang;
			return o;
		}

		function Wall(x, y, fang) {
			var o = new Youxuetiao(x, y, WALL_W, WALL_H, "img/qiang.gif", QIANG);
			o.boom = function() {
				var baozha = new Baozha(o);
				stage.add(baozha);
			}
			o.fang = fang;
			return o;
		}

		function Tank(x, y, w, h, src, type, speed, gong, fang, dir, filename) {
			var o = new Youxuetiao(x, y, w, h, src, type);
			o.speed = speed;
			o.gong = gong;
			o.fang = fang;
			o.dir = dir; //坦克的方向 LURD 上下左右
			o.filename = filename;
			o.left = false;
			o.right = false;
			o.up = false;
			o.down = false;
			o.movetimer = setInterval(yidong, 40, o);

			o.toLeft = function() {
				o.dir = "L";
				o.left = true;
				o.right = false;
				o.up = false;
				o.down = false;
				o.img.src = "img/" + o.filename + o.dir + ".gif";
			}
			o.toRight = function() {
				o.dir = "R";
				o.left = false;
				o.right = true;
				o.up = false;
				o.down = false;
				o.img.src = "img/" + o.filename + o.dir + ".gif";
			}
			o.toUP = function() {
				o.dir = "U";
				o.left = false;
				o.right = false;
				o.up = true;
				o.down = false;
				o.img.src = "img/" + o.filename + o.dir + ".gif";
			}
			o.toDown = function() {
				o.dir = "D";
				o.left = false;
				o.right = false;
				o.up = false;
				o.down = true;
				o.img.src = "img/" + o.filename + o.dir + ".gif";
			}
			o.stopLeft = function() {
				o.left = false;
			}
			o.stopRight = function() {
				o.right = false;
			}
			o.stopUp = function() {
				o.up = false;
			}
			o.stopDown = function() {
				o.down = false;
			}
			o.fire = function() {
				if(o.life <= 0) return;
				var zd = new Zidan(o);
				stage.add(zd);
			}
			o.boom = function() {
				var baozha = new Baozha(o);
				stage.add(baozha);
			}
			o.eat = function(dj) {
				jiandaoju(o, dj);
			}
			return o;
		}

		function Wojun(x, y) {
			var o = new Tank(x, y, TANK_W, TANK_H, WO_IMG, WOJUN, 3, 0, 0, "U", "坦克3");
			o.dilei = 2;
			o.fuhuo = 3;
			o.relife = function() {
				o.life = 100;
				o.gong = 0;
				o.fang = 0;
				o.speed = 3;
				o.dilei = 2;
				o.fuhuo--;
				o.left = false;
				o.right = false;
				o.up = false;
				o.down = false;
				//检验坐标是否碰撞
				jiancha(o);
				stage.add(o);
				clearInterval(djstimer);
				djshijian = 9;
				o.movetimer = setInterval(yidong, 40, o);
				zhuangtai = zt[7];
				shantimer = setInterval(function() {
					shan = !shan;
					if(shan) {
						stage.remove(o);
					} else {
						stage.add(o);
					}
				}, 20);
				timer9 = setInterval(function() {
					shanshijian--;
					if(shanshijian == 0) { //为下次闪烁作准备
						jiancha(o);
						stage.remove(o);
						stage.add(o);
						shanshijian = 3;
						shan = false;
						clearInterval(shantimer);
						clearInterval(timer9);
						zhuangtai = enemycount > 0 ? (boss.life > 0 ? zt[10] : zt[1]) : zhuangtai; //状态变成激战
					}
				}, 900)
			}

			o.mailei = function() {
				if(o.dilei < 1) return;
				var lei = new Dilei(o);
				stage.add(lei);
				o.dilei--;
			}
			o.dazhao = function() { //大招
				if(o.life <= 3) return;
				o.life -= 3;
				var fx = o.dir;
				o.dir = "U";
				o.fire(o);
				o.dir = "L";
				o.fire(o);
				o.dir = "R";
				o.fire(o);
				o.dir = "D";
				o.fire(o);
				o.dir = fx;
			}
			return o;
		}

		function Dijun(x, y, isboss) {
			var o = new Tank(x, y, DI_W, DI_H, isboss ? BOSS_IMG : DI_IMG, DIJUN, 3, 0, 0, "D", isboss ? "boss1" : "tank");
			var n = parseInt(Math.random() * 100);
			o.hero = n % 5 == 0;
			if(o.hero && !isboss) { //英雄坦克比较厉害，所以速度，攻防都较高
				o.speed = 4;
				o.gong = 2;
				o.fang = 2;
				o.filename = "d";
				o.img.src = "img/" + o.filename + o.dir + ".gif";
			}
			o.kongzhitimer = setInterval(function() {
				if(zhuangtai == zt[0] || zhuangtai == zt[2] || zhuangtai == zt[5] || zhuangtai == zt[9])
					return;
				n = parseInt(Math.random() * 100);
				if(n % 39 == 0) { //决定是否可以改变方向
					if(o.isboss) {
						o.speed = parseInt(Math.random() * 15);
					}
					n = parseInt(Math.random() * 4);
					if(n == 0) o.toUP();
					else if(n == 1) o.toDown();
					else if(n == 2) o.toLeft();
					else if(n == 3) o.toRight();
				}
				if(isboss) {
					o.jiguang = function() {
						if(o.life <= 0) return;
						var jiguang = new Jiguang(o);
						stage.add(jiguang.o1);
						stage.add(jiguang.o2);
					}
					o.danmu = function() {
						if(o.life <= 0) return;
						var danmu = new Danmu(o);
						stage.add(danmu.o1);
						stage.add(danmu.o2);
						stage.add(danmu.o3);
						stage.add(danmu.o4);
						stage.add(danmu.o5);
						stage.add(danmu.o6);
						stage.add(danmu.o7);
						stage.add(danmu.o8);
						stage.add(danmu.o9);
						stage.add(danmu.o10);
						stage.add(danmu.o11);
						stage.add(danmu.o12);
						stage.add(danmu.o13);
						stage.add(danmu.o14);
						stage.add(danmu.o15);
						stage.add(danmu.o16);
					}
					var k = parseInt(Math.random() * 100);
					if(k % 19 == 0) {
						o.fire();
					} else if(k % 33 == 0) {
						o.jiguang();
					} else if(k % 50 == 0) {
						o.danmu();
					}
				} else {
					var k = parseInt(Math.random() * 100);
					if(k % 19 == 0) {
						o.fire();
					}
				}
			}, 30);
			return o;
		}

		function initWall() {
			var x = (can.width - wallcount * WALL_W) / 2;
			var y = 150;
			for(var i = 0; i < wallcount; i++) {
				var o = new Wall(x, y, 2);
				stage.add(o);
				x += WALL_W;
			}
			var x = can.width / 4 - 50 - 13;
			var y = 500;
			for(var i = 0; i < wallcount2; i++) {
				var o = new Wall(x, y, 2);
				stage.add(o);
				if(i == wallcount2 / 2 - 1) {
					x += can.width - (wallcount2 / 2 - 1) * WALL_W - (can.width / 4 - 50) * 2;
				}

				if(i >= wallcount2 / 4) {
					if(i >= wallcount2 / 4 * 3 - 1) {
						y += WALL_H;
					} else {
						x += WALL_W;
					}
				} else {
					y -= WALL_H;

				}
			}
		}

		function initEnemy() {
			var x = (can.width - enemycount * DI_W - enemycount * 5) / 2;
			var y = 80;
			for(var i = 0; i < enemycount; i++) {
				var o = new Dijun(x, y, false);
				stage.add(o);
				x += DI_W + 5;
			}
		}

		function initHome() {
			var x = mm.x - 35;
			var y = mm.y - 35;
			var o = new Wall(x, y, 3);
			stage.add(o);
			x += WALL_W;
			zhb.push(o);

			o = new Wall(x, y, 3);
			stage.add(o);
			x += WALL_W;
			zhb.push(o);

			o = new Wall(x, y, 3);
			stage.add(o);
			x += WALL_W;
			zhb.push(o);

			o = new Wall(x, y, 3);
			stage.add(o);
			x += WALL_W;
			zhb.push(o);

			x = mm.x - 35;
			y = y + 30;

			o = new Wall(x, y, 3);
			stage.add(o);
			x += WALL_W * 3;
			zhb.push(o);

			o = new Wall(x, y, 3);
			stage.add(o);
			x += WALL_W * 3;
			zhb.push(o);

			x = mm.x - 35;
			y = y + 30;

			o = new Wall(x, y, 3);
			o.h += 15;
			stage.add(o);
			x += WALL_W * 3;
			zhb.push(o);

			o = new Wall(x, y, 3);
			o.h += 15;
			stage.add(o);
			x += WALL_W * 3;
			zhb.push(o);
		} //定义一个存储器对象
		var stage = new Stage();

		var wo = new Wojun(300, 600);
		var mm = new Command((can.width - MM_W) / 2 + 20, (can.height - MM_H), 2);

		function chanshengboss() {
			wo.x = 300;
			wo.y = 600;
			var bw = 250;
			var bh = 250;
			boss = new Dijun((can.width - bw) / 2, -bh, true);
			enemycount++;
			boss.gong = 4;
			boss.isboss = true;
			boss.w = bw;
			boss.h = bh;
			boss.src = "img/boss1D.gif";
			boss.life = 10000;
			stage.add(boss);
			var chuchangtimer = setInterval(function() {
				boss.y += 0.5;
				if(boss.y >= 100) {
					clearInterval(chuchangtimer);
					zhuangtai = zt[10];
					bgm1.src = "sounds/bgm2.mp3";
					bgm1.play();
				}
			}, 20)
		}

		stage.add(mm);
		stage.add(wo); //构建一排障碍墙
		initWall();

		//构造一排敌人
		initEnemy();

		//构造指挥部
		initHome();

		stage.render();

		kaishitimer = setInterval(function() {
			kaishicolor = !kaishicolor;
		}, 200);

		window.onkeyup = function() {
			var c = event.keyCode;
			if(c == 82 && zhuangtai == zt[8]) {
				wo.relife();
				zhuangtai = enemycount > 0 ? zt[7] : zhuangtai;
			}
			if(c == 89 && zhuangtai == zt[0]) {
				zhuangtai = zt[1];
				clearInterval(kaishitimer);
				bofang("go.wav");
				gametimer = setInterval(function() {
					if(zhuangtai == zt[2]) return;
					gametime--;

					if(gametime == 0) {
						mm.die();
						clearInterval(gametimer);
					}
				}, 1000);
			} else if(c == 80 && zhuangtai != zt[0]) {
				if(zhuangtai == zt[3] || zhuangtai == zt[4] || zhuangtai == zt[5] || zhuangtai == zt[6] || zhuangtai == zt[8] || zhuangtai == zt[9]) return;
				if(zhuangtai != zt[2]) {
					tempstate = zhuangtai;
				}
				zhuangtai = zhuangtai == zt[2] ? tempstate : zt[2]; //暂停游戏
				if(zhuangtai == zt[2]) {
					wo.left = false;
					wo.right = false;
					wo.up = false;
					wo.down = false;
				}
			}
			if(zhuangtai == zt[0] || zhuangtai == zt[2] || zhuangtai == zt[4] ||
				zhuangtai == zt[6] || zhuangtai == zt[8]) {
				return;
			}

			if(c == 37) {
				wo.stopLeft();
			} else if(c == 38) {
				wo.stopUp();
			} else if(c == 39) {
				wo.stopRight();
			} else if(c == 40) {
				wo.stopDown();
			} else if(c == 32) {
				if(wo.life <= 0) return;
				wo.fire();
				bofang("attack.mp3");
			} else if(c == 66) {
				wo.mailei();
			} else if(c == 65) {
				wo.dazhao();
			}
		}

		window.onkeydown = function() {
			var c = event.keyCode;
			if(zhuangtai == zt[0] || zhuangtai == zt[2] || zhuangtai == zt[4] ||
				zhuangtai == zt[6] || zhuangtai == zt[8] || zhuangtai == zt[3] || zhuangtai == zt[9]) {
				return;
			}
			if(c == 37) {
				wo.toLeft();
			} else if(c == 38) {
				wo.toUP();
			} else if(c == 39) {
				wo.toRight();
			} else if(c == 40) {
				wo.toDown();
			}
		}

		/**检查o是否超出屏幕范围**/
		function checkOut(o) {
			return o.x < 0 || o.y < 0 || o.x > can.width - o.w || o.y > can.height - o.h;
		}

		/**当前物体o与界面上所有物体的碰撞检验**/
		function pengzhuang(o) {
			var r = new Object();
			r.peng = false;
			var list = stage.data;
			for(var i in list) {
				var m = list[i];
				if(m.index == o.index) continue; //避开自己与自己的碰撞
				if(m.type == TUPIAN) continue; //避开与图片的碰撞
				if(o.type == WOJUN && m.type == ZIDAN) continue; //避开坦克与子弹的碰撞
				if(o.type == DIJUN && m.type == ZIDAN) continue; //避开坦克与子弹的碰撞
				if(o.type == ZIDAN && m.type == ZIDAN) continue; //避开子弹与子弹的碰撞
				if(o.type == ZIDAN && m.type == DAOJU) continue; //避开子弹与道具的碰撞
				if(o.type == WOJUN && m.type == DILEI) continue; //避开我军与地雷的碰撞
				if(o.type == ZIDAN && m.type == DILEI) continue; //避开子弹与地雷的碰撞

				if(o.type == DIJUN && m.type == FEIJI) continue; //避开敌军与飞机的碰撞
				if(o.type == WOJUN && m.type == FEIJI) continue; //避开我军与飞机的碰撞
				if(o.type == ZIDAN && m.type == FEIJI) continue; //避开子弹与飞机的碰撞
				if(o.type == FEIJI) continue; //飞机避开所有
				if(o.type == ZIDAN && o.tank.type == DIJUN && m.type == FEIJI) continue; //避开子弹与盟军的碰撞
				if(o.type == ZIDAN && o.tank.type == DIJUN && m.type == DIJUN) continue; //避开子弹与盟军的碰撞
				if(hitForRectangle(o, m)) {
					r.peng = true;
					r.o = m;
					break;
				}
			}
			return r;
		}

		/**
		 * 矩形物体碰撞检验
		 * @param {Object} o1
		 * @param {Object} o2
		 */
		function hitForRectangle(o1, o2) {
			if(o1.x < o2.x) {
				if(o2.x - o1.x <= o1.w) {
					if(o1.y < o2.y) {
						return o2.y - o1.y <= o1.h;
					} else if(o1.y > o2.y) {
						return o1.y - o2.y <= o2.h;
					} else
						return o1.y == o2.y;
				}
			} else if(o1.x > o2.x) {
				if(o1.x - o2.x <= o2.w) {
					if(o1.y < o2.y) {
						return o2.y - o1.y <= o1.h;
					} else if(o1.y > o2.y) {
						return o1.y - o2.y <= o2.h;
					} else
						return o1.y == o2.y;
				}
			} else {
				if(o1.y < o2.y) {
					return o2.y - o1.y <= o1.h;
				} else if(o1.y > o2.y) {
					return o1.y - o2.y <= o2.h;
				} else
					return o1.y == o2.y;
			}
			return false;
		}

		function bofang(src) {
			var audio = new Audio();
			audio.src = "sounds/" + src;
			audio.play();
		}

		function jiandaoju(o, dj) {
			dj.die();
			if(dj.n == 0) { //speed++
				o.speed++;
				o.speed = o.speed > 8 ? 8 : o.speed;
				if(o.type == WOJUN)
					bofang("prop.mp3");
			} else if(dj.n == 1) { //life++
				if(o.type == WOJUN) {
					o.fuhuo++;
					o.fuhuo = o.fuhuo > 6 ? 6 : o.fuhuo;
					bofang("prop.mp3");
				} else {
					createNewEnemy(5);
				}
			} else if(dj.n == 2) { //冰冻
				if(o.type == WOJUN) {
					changeState(zt[5]);
					bofang("daxiao.wav");
				} else {
					if(zhuangtai == zt[7]) return;
					changeState(zt[6]);
					bofang("stop.wav");
				}
			} else if(dj.n == 3) { //atk++
				o.gong++;
				o.gong = o.gong > 4 ? 4 : o.gong;
				if(o.type == WOJUN)
					bofang("prop.mp3");
			} else if(dj.n == 4) { //def++
				o.fang++;
				o.fang = o.fang > 4 ? 4 : o.fang;
				if(o.type == WOJUN)
					bofang("prop.mp3");
			} else if(dj.n == 5) { //加固总部
				if(o.type == WOJUN) {
					zhihuibu(20);
					bofang("bready.wav");
				} else {
					zhihuibu(-20);
				}
			} else if(dj.n == 6) { //加血
				o.life += 30;
				o.life = o.life > (o.isboss ? BOSSHP : 100) ? (o.isboss ? BOSSHP : 100) : o.life;
				if(o.type == WOJUN)
					bofang("prop.mp3");
			} else if(dj.n == 7) { //减血
				if(zhuangtai == zt[7] && o.type == WOJUN) return;
				o.life -= (parseInt(Math.random() * 30) + 60);
				if(o.life <= 0) {
					o.die();
				}
				bofang("bomb1.wav");
			} else if(dj.n == 8) { //给指挥官加血
				if(o.type == WOJUN) {
					mm.life += 30;
					mm.life = mm.life > 100 ? 100 : mm.life;
					bofang("prop.mp3");
				} else {
					jiaxue();
					createNewEnemy(3);
				}
			} else if(dj.n == 9) { //地雷+2
				if(o.type == WOJUN) {
					o.dilei += 2;
					o.dilei = o.dilei > 10 ? 10 : o.dilei;
					bofang("prop.mp3");
				} else {
					shengfang();
					createNewEnemy(3);
				}
			}
		}

		function jiaxue() {
			var list = stage.data;
			for(var i = 0; i < list.length; i++) {
				if(list[i].type == DIJUN) {
					list[i].life += 10 + parseInt(Math.random() * 40);
					list[i].life = list[i].life > 100 ? 100 : list[i].life;
				}
			}
		}

		function shengfang() {
			var list = stage.data;
			for(var i = 0; i < list.length; i++) {
				if(list[i].type == DIJUN) {
					list[i].fang++;
					list[i].fang = list[i].fang > 4 ? 4 : list[i].fang;
				}
			}
		}

		function createNewEnemy(count) {
			if(enemycount > 100) return;
			for(var i = 0; i < count; i++) {
				var x = parseInt(Math.random() * (can.width - 200)) + 80;
				var y = parseInt(Math.random() * (can.height - 150)) + 50;
				var o = new Dijun(x, y);
				var r = pengzhuang(o);
				while(r.peng) {
					x = parseInt(Math.random() * (can.width - 200)) + 80;
					y = parseInt(Math.random() * (can.height - 150)) + 50;
					o.x = x;
					o.y = y;
					r = pengzhuang(o);
				}
				stage.add(o);
			}
			enemycount += count;
			gametime += 150;
		}

		function zhihuibu(xue) {
			for(var i in zhb) {
				if(xue > 0 && zhb[i].life <= 0) {
					stage.add(zhb[i]);
				}
				zhb[i].life += xue;
				zhb[i].life = zhb[i].life > 100 ? 100 : zhb[i].life;
				if(zhb[i].life <= 0) {
					zhb[i].die();
				}
			}
		}

		function changeState(st) {
			if(zhuangtai == zt[3] || zhuangtai == zt[4] || zhuangtai == zt[8] || zhuangtai == zt[5] || zhuangtai == zt[6]) return;
			tempstate = zhuangtai; //记录一下冰冻以前的状态
			zhuangtai = st;
			//启动解冻定时器
			bdtimer = setInterval(function() {
				bdshijian--;
				if(bdshijian <= 0) {
					bdshijian = 5;
					clearInterval(bdtimer);
					zhuangtai = zhuangtai == zt[5] || zhuangtai == zt[6] ? tempstate : zhuangtai;
				}
			}, 1000);
		}

		function over() {
			if(overtimer == null) {
				overtimer = setInterval(function() {
					overy -= 4;
					if(overy <= can.height / 2 + 100) {
						clearInterval(overtimer);
					}
				}, 20);
			}
			bofang("lost.wav");
		}

		function yidong(o) {
			if(zhuangtai == zt[2]) return;
			if(o.type == DIJUN) {
				if(zhuangtai == zt[0] || zhuangtai == zt[5])
					return;
			} else {
				if(zhuangtai == zt[6]) {
					o.left = false;
					o.right = false;
					o.up = false;
					o.down = false;
				}
			}
			var ox = o.x;
			oy = o.y; //保存移动以前的旧标
			if(o.left) {
				o.x -= o.speed;
			} else if(o.right) {
				o.x += o.speed;
			} else if(o.up) {
				o.y -= o.speed;
			} else if(o.down) {
				o.y += o.speed;
			}
			if(checkOut(o)) { //移动后，发现坐标超出范围，就恢复为旧坐标
				o.x = ox;
				o.y = oy;
			}
			var r = pengzhuang(o);
			if(r.peng) { //是否与其他物体发生了碰撞，如果有就恢复旧坐标
				if(r.o.type == DAOJU) {
					o.eat(r.o); //吃道具
				}
				if(r.o.type == DILEI) {
					r.o.die();
					var m = 40 + parseInt(Math.random() * 55);
					o.shixue(m);
					var bz = new Baozha(r.o);
					stage.add(bz);
					bofang("hedan.wav");
				} else {
					o.x = ox;
					o.y = oy;
				}
			}

		}

		function jiancha(o) {
			var r = pengzhuang(o);
			while(r.peng && (r.o.type == DIJUN || r.o.type == QIANG)) {
				o.x = parseInt(Math.random() * (can.width - 100)); //复活时随机给个位子
				o.y = parseInt(Math.random() * (can.height - 100));
				//				if(o.x > can.width / 2) {
				//					o.x -= 10;
				//				} else if(o.x < can.width / 2) {
				//					o.x += 10;
				//				}
				//				if(o.y > can.height / 2) {
				//					o.y -= 10;
				//				} else {
				//					o.y += 10;
				//				}
				r = pengzhuang(o);
			}
		}

		function dierguan() { //boos关
			dier = true;
			guan2.style.display = "none";
			wo.gong = 4, wo.fang = 4, wo.speed = 6, wo.fuhuo = 4, wo.dilei = 4;
			bgm1.pause();
			zhuangtai = zt[9];
			var list = stage.data;
			for(var i = 0; i < list.length; i++) {
				if(list[i].type == DIJUN || list[i].type == QIANG) {
					list[i].life = 0;
					list[i].die();
					i--;
				}
			}
			zhuangtai = zt[9];
			var mmtimer = setInterval(function() {
				mm.x += 1;
				if(mm.x >= can.width + 100) {
					clearInterval(mmtimer);
					bgm1.src = "sounds/chuchang.mp3";
					bgm1.play();
					doudong();
					chanshengboss();
				}
			}, 10)
		}

		function doudong() {
			/**屏幕抖动实现**/
			var doux = 15,
				douy = 15,
				wantchange = 0;
			var doutimer = setInterval(function() {
				wantchange++;
				cx += wantchange % 2 == 0 ? -doux : doux;
				cy += wantchange % 2 == 0 ? -douy : douy;
				if(wantchange % 2 == 0) {
					doux -= 1.5;
					douy -= 1.5;
					if(doux == 0) doux = 15, douy = 15;
				}
				can.style.left = cx + "px";
				can.style.top = cy + "px";
			}, 32);
			setTimeout(function() {
				clearInterval(doutimer);
				bgm1.pause();
			}, 13000)
		}

		feijitimer = setInterval(function() {
			if(zhuangtai == zt[2] || zhuangtai == zt[0]) return;

			var n = parseInt(Math.random() * 100);
			if(n % 10 == 0) {
				if(fjcount < 10) {
					var fj = new Feiji();
					stage.add(fj);
					fjcount++;
				}
			}

		}, 1000);
	</script>

</html>